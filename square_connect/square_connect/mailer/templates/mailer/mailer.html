{% extends "app/layout.html" %}

{% block content %}

<div class="jumbotron">
    <h1>Mailer</h1>
    <h2>Add New Employee</h2>
    <form method="post">
        {% csrf_token %}	    
	<div class="form-group">
		<label for="mailing_list">Mailing List</label>
		<select id="mailing_list" name="mailing_list" class="form-control">
			<option value="">Mailing List</option>
			{% for list in mailing_lists %}
				<option value="{{ list.id }}">{{ list }}</option>
			{% endfor %}
		</select>
	</div>
	<div class="form-group">
		<label for="first_name">First Name</label>
                <input id="first_name" name="first_name" class="form-control" value="{{ first_name }}"></input>
       	</div>
        <div class="form-group">
		<label for="last_name">Last Name</label>
                <input id="last_name" name="last_name" class="form-control" value="{{ last_name }}"></input>
        </div>
	<div class="form-group">
		<label for="email">Email</label>
                <input id="email" name="email" class="form-control" value="{{ email }}"></input>
        </div>
       <button type="submit" class="btn btn-default">Add person</button>
    </form>
    <h2>Current Mailing Lists</h2>
    {% for list in mailing_lists %}
	<button class="btn btn-default" type="button" data-toggle="collapse" data-target="#{{ list.id }}" aria-expanded="false" aria-controls="collapseExample">
    		{{ list.service }}
    	</button>
	<div class="collapse" id="{{ list.id }}">
  		<div class="card card-block">
        		{% for person in list.members %}
            			<p>
					{{ person.first_name }} {{ person.last_name }}: {{ person.email }}
					<button type="button" class="btn btn-default delete-person-submit" data-person="{{ person.id }}">Delete</button> 
	   			</p>
        		{% endfor %}
		</div>
	</div>
	<br>
    {% endfor %}
</p>
</div>
    <form id="delete-person-form" method="post">
        {% csrf_token %}
        <input type="hidden" id="delete-person-input" name="person">
    </form>
</div>

<script>
$(document).ready(function() {
    $(".delete-person-submit").click(function() {
        $("#delete-person-input").val(event.target.dataset.person);
        $("#delete-person-form").submit();
    });
});
</script>

{% endblock %}
